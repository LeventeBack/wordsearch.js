/**
 * wordsearch.js
 *
 * Generate a wordsearch puzzle
 *
 * Author: Dave Eddy <dave@daveeddy.com>
 * Date: 2/24/13
 * @preserve
 */
(function(){function r(r,e,o,h){if(!r||!r.length)return!1;e=e||20,o=o||20,h=h||{},h.backwards=h.hasOwnProperty("backwards")?h.backwards:.5,r=r.filter(function(r){return t.test(r)}),r.sort(function(r,a){return r.length<a.length?-1:1});for(var i=Array(o),l=0;i.length>l;l++)i[l]=Array(e);for(var d=[],f=0,l=0;r.length>l;l++){var s=originalword=r[l];Math.random()<h.backwards&&(s=s.split("").reverse().join(""));for(var g=0;20>g;){var c=Math.floor(4*Math.random()),m=a(s,c,e,o);if(0>m.maxx||0>m.maxy){d.push(originalword);break}for(var x=ox=Math.floor(Math.random()*(m.maxx-m.minx)+m.minx),u=oy=Math.floor(Math.random()*(m.maxy-m.miny)+m.miny),y=!0,v=0;s.length>v;v++){if(i[u][x]&&i[u][x]!==s.charAt(v)){y=!1;break}u+=m.dy,x+=m.dx}if(y){x=ox,u=oy;for(var v=0;s.length>v;v++)i[u][x]=s.charAt(v),h.color&&(i[u][x]="["+(f+41)+"m"+i[u][x]+"[0m"),u+=m.dy,x+=m.dx;break}g++}g>=20&&d.push(originalword),f=(f+1)%6}for(var w=JSON.parse(JSON.stringify(i)),l=0;i.length>l;l++)for(var b=0;i[l].length>b;b++)i[l][b]||(i[l][b]=n.charAt(Math.floor(Math.random()*n.length)));return{grid:i,solved:w,unplaced:d}}function a(r,a,n,t){var e=0,o=0,h=n-1,i=t-1,l=0,d=0;switch(a){case 0:i=t-1,o=r.length-1,d=-1,h=n-r.length,e=0,l=1;break;case 1:h=n-r.length,e=0,l=1;break;case 2:o=0,i=t-r.length,d=1,h=n-r.length,e=0,l=1;break;case 3:o=0,i=t-r.length,d=1;break;default:}return{maxx:h,maxy:i,minx:e,miny:o,dx:l,dy:d}}var n="abcdefghijklmnopqrstuvwxyz",t=/^[a-z]+$/;"undefined"==typeof exports?window.wordsearch=r:module.exports=r})();